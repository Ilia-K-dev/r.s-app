{"ast":null,"code":"\"use strict\";\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\nvar _get = require(\"@babel/runtime/helpers/get\");\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _superPropGet(t, o, e, r) { var p = _get(_getPrototypeOf(1 & r ? t.prototype : t), o, e); return 2 & r && \"function\" == typeof p ? function (t) { return p.apply(e, t); } : p; }\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar expo_pwa_1 = require(\"expo-pwa\");\nvar webpack_1 = require(\"webpack\");\nvar JsonWebpackPlugin_1 = __importDefault(require(\"./JsonWebpackPlugin\"));\nfunction maybeFetchPlugin(compiler, name) {\n  var _a, _b;\n  return (_b = (_a = compiler.options) === null || _a === void 0 ? void 0 : _a.plugins) === null || _b === void 0 ? void 0 : _b.map(function (_ref) {\n    var constructor = _ref.constructor;\n    return constructor;\n  }).find(function (constructor) {\n    return constructor && constructor.name === name;\n  });\n}\nvar PwaManifestWebpackPlugin = function (_JsonWebpackPlugin_1$) {\n  function PwaManifestWebpackPlugin(pwaOptions, manifest) {\n    var _this;\n    _classCallCheck(this, PwaManifestWebpackPlugin);\n    _this = _callSuper(this, PwaManifestWebpackPlugin, [{\n      path: pwaOptions.path,\n      json: manifest,\n      pretty: true\n    }]);\n    _this.pwaOptions = pwaOptions;\n    _this.rel = 'manifest';\n    return _this;\n  }\n  _inherits(PwaManifestWebpackPlugin, _JsonWebpackPlugin_1$);\n  return _createClass(PwaManifestWebpackPlugin, [{\n    key: \"apply\",\n    value: function apply(compiler) {\n      var _this2 = this;\n      _superPropGet(PwaManifestWebpackPlugin, \"apply\", this, 3)([compiler]);\n      compiler.hooks.compilation.tap(this.constructor.name, function (compilation) {\n        compilation.hooks.processAssets.tapPromise({\n          name: _this2.constructor.name,\n          stage: webpack_1.Compilation.PROCESS_ASSETS_STAGE_ADDITIONAL\n        }, _asyncToGenerator(function* () {\n          var HtmlWebpackPlugin = maybeFetchPlugin(compiler, 'HtmlWebpackPlugin');\n          if (HtmlWebpackPlugin) {\n            if (typeof HtmlWebpackPlugin.getHooks === 'undefined') {\n              compilation.errors.push(new webpack_1.WebpackError('PwaManifestWebpackPlugin - This PwaManifestWebpackPlugin version is not compatible with your current HtmlWebpackPlugin version.\\n'));\n              return;\n            }\n            HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(_this2.constructor.name, function (data, htmlCallback) {\n              var isInjectionAllowed;\n              if (typeof _this2.pwaOptions.inject === 'boolean') {\n                isInjectionAllowed = _this2.pwaOptions.inject;\n              } else if (typeof _this2.pwaOptions.inject === 'function') {\n                isInjectionAllowed = _this2.pwaOptions.inject(data.plugin);\n              } else {\n                isInjectionAllowed = data.plugin.options.pwaManifest !== false;\n              }\n              if (isInjectionAllowed === false) {\n                return htmlCallback(null, data);\n              }\n              data.assetTags.meta.push({\n                tagName: 'link',\n                voidTag: true,\n                attributes: {\n                  rel: _this2.rel,\n                  href: (0, expo_pwa_1.joinUrlPath)(_this2.pwaOptions.publicPath, _this2.pwaOptions.path)\n                }\n              });\n              htmlCallback(null, data);\n            });\n          }\n        }));\n      });\n    }\n  }]);\n}(JsonWebpackPlugin_1.default);\nexports.default = PwaManifestWebpackPlugin;","map":{"version":3,"names":["expo_pwa_1","require","webpack_1","JsonWebpackPlugin_1","__importDefault","maybeFetchPlugin","compiler","name","_b","_a","options","plugins","map","_ref","constructor","find","PwaManifestWebpackPlugin","_JsonWebpackPlugin_1$","pwaOptions","manifest","_this","_classCallCheck","_callSuper","path","json","pretty","rel","_inherits","_createClass","key","value","apply","_this2","_superPropGet","hooks","compilation","tap","processAssets","tapPromise","stage","Compilation","PROCESS_ASSETS_STAGE_ADDITIONAL","_asyncToGenerator","HtmlWebpackPlugin","getHooks","errors","push","WebpackError","alterAssetTags","tapAsync","data","htmlCallback","isInjectionAllowed","inject","plugin","pwaManifest","assetTags","meta","tagName","voidTag","attributes","href","joinUrlPath","publicPath","default","exports"],"sources":["C:\\Users\\user\\Documents\\app.v3\\client\\node_modules\\@expo\\webpack-config\\src\\plugins\\PwaManifestWebpackPlugin.ts"],"sourcesContent":["import { joinUrlPath } from 'expo-pwa';\nimport { Compilation, Compiler, WebpackError, WebpackPluginInstance } from 'webpack';\n\nimport JsonWebpackPlugin from './JsonWebpackPlugin';\nimport { HTMLPluginData } from './ModifyHtmlWebpackPlugin';\n\nexport type Icon = {\n  src: string;\n  sizes: string;\n  type: 'image/png';\n};\n\nfunction maybeFetchPlugin(compiler: Compiler, name: string): WebpackPluginInstance | undefined {\n  return compiler.options?.plugins\n    ?.map(({ constructor }) => constructor)\n    .find(constructor => constructor && constructor.name === name);\n}\n\nexport type PwaManifestOptions = {\n  path: string;\n  inject?: boolean | Function;\n  publicPath: string;\n};\n\nexport default class PwaManifestWebpackPlugin extends JsonWebpackPlugin {\n  rel: string = 'manifest';\n\n  constructor(private pwaOptions: PwaManifestOptions, manifest: any) {\n    super({\n      path: pwaOptions.path,\n      json: manifest,\n      pretty: true,\n    });\n  }\n\n  apply(compiler: Compiler) {\n    super.apply(compiler);\n\n    compiler.hooks.compilation.tap(this.constructor.name, (compilation: Compilation) => {\n      compilation.hooks.processAssets.tapPromise(\n        {\n          name: this.constructor.name,\n          // https://github.com/webpack/webpack/blob/master/lib/Compilation.js#L3280\n          stage: Compilation.PROCESS_ASSETS_STAGE_ADDITIONAL,\n        },\n        async () => {\n          // Hook into the html-webpack-plugin processing and add the html\n          const HtmlWebpackPlugin = maybeFetchPlugin(compiler, 'HtmlWebpackPlugin') as any;\n          if (HtmlWebpackPlugin) {\n            if (typeof HtmlWebpackPlugin.getHooks === 'undefined') {\n              compilation.errors.push(\n                new WebpackError(\n                  'PwaManifestWebpackPlugin - This PwaManifestWebpackPlugin version is not compatible with your current HtmlWebpackPlugin version.\\n'\n                )\n              );\n              return;\n            }\n\n            HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(\n              this.constructor.name,\n              (\n                data: HTMLPluginData,\n                htmlCallback: (error: Error | null, data: HTMLPluginData) => void\n              ) => {\n                // Skip if a custom injectFunction returns false or if\n                // the htmlWebpackPlugin options includes a `favicons: false` flag\n                let isInjectionAllowed: boolean;\n                if (typeof this.pwaOptions.inject === 'boolean') {\n                  isInjectionAllowed = this.pwaOptions.inject;\n                } else if (typeof this.pwaOptions.inject === 'function') {\n                  isInjectionAllowed = this.pwaOptions.inject(data.plugin);\n                } else {\n                  isInjectionAllowed = data.plugin.options.pwaManifest !== false;\n                }\n\n                if (isInjectionAllowed === false) {\n                  return htmlCallback(null, data);\n                }\n\n                data.assetTags.meta.push({\n                  tagName: 'link',\n                  voidTag: true,\n                  attributes: {\n                    rel: this.rel,\n                    href: joinUrlPath(this.pwaOptions.publicPath, this.pwaOptions.path),\n                  },\n                });\n\n                htmlCallback(null, data);\n              }\n            );\n          }\n        }\n      );\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}