{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from 'axios';\nimport { auth } from \"../../../core/config/firebase\";\nvar API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001';\nvar getAuthToken = function () {\n  var _ref = _asyncToGenerator(function* () {\n    var user = auth.currentUser;\n    if (!user) {\n      throw new Error('User not authenticated');\n    }\n    return yield user.getIdToken();\n  });\n  return function getAuthToken() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var receiptApi = {\n  createReceipt: function () {\n    var _createReceipt = _asyncToGenerator(function* (receiptData) {\n      var imageFile = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      try {\n        var token = yield getAuthToken();\n        if (imageFile) {\n          var formData = new FormData();\n          formData.append('receipt', imageFile);\n          formData.append('data', JSON.stringify(receiptData));\n          var response = yield axios.post(`${API_URL}/api/receipts/upload`, formData, {\n            headers: {\n              'Content-Type': 'multipart/form-data',\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          return response.data;\n        } else {\n          var _response = yield axios.post(`${API_URL}/api/receipts`, receiptData, {\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          return _response.data;\n        }\n      } catch (error) {\n        var _error$response, _error$response$data;\n        throw new Error(`Failed to create receipt: ${((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.message) || error.message}`);\n      }\n    });\n    function createReceipt(_x) {\n      return _createReceipt.apply(this, arguments);\n    }\n    return createReceipt;\n  }(),\n  getReceipts: function () {\n    var _getReceipts = _asyncToGenerator(function* () {\n      var filters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      try {\n        var token = yield getAuthToken();\n        var response = yield axios.get(`${API_URL}/api/receipts`, {\n          params: filters,\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        return response.data;\n      } catch (error) {\n        var _error$response2, _error$response2$data;\n        throw new Error(`Failed to fetch receipts: ${((_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.message) || error.message}`);\n      }\n    });\n    function getReceipts() {\n      return _getReceipts.apply(this, arguments);\n    }\n    return getReceipts;\n  }(),\n  getReceiptById: function () {\n    var _getReceiptById = _asyncToGenerator(function* (receiptId) {\n      try {\n        var token = yield getAuthToken();\n        var response = yield axios.get(`${API_URL}/api/receipts/${receiptId}`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        return response.data;\n      } catch (error) {\n        var _error$response3, _error$response3$data;\n        throw new Error(`Failed to fetch receipt: ${((_error$response3 = error.response) == null ? void 0 : (_error$response3$data = _error$response3.data) == null ? void 0 : _error$response3$data.message) || error.message}`);\n      }\n    });\n    function getReceiptById(_x2) {\n      return _getReceiptById.apply(this, arguments);\n    }\n    return getReceiptById;\n  }(),\n  updateReceipt: function () {\n    var _updateReceipt = _asyncToGenerator(function* (receiptId, updateData) {\n      var newImageFile = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      try {\n        var token = yield getAuthToken();\n        if (newImageFile) {\n          var formData = new FormData();\n          formData.append('receipt', newImageFile);\n          formData.append('data', JSON.stringify(updateData));\n          var response = yield axios.put(`${API_URL}/api/receipts/${receiptId}/upload`, formData, {\n            headers: {\n              'Content-Type': 'multipart/form-data',\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          return response.data;\n        } else {\n          var _response2 = yield axios.put(`${API_URL}/api/receipts/${receiptId}`, updateData, {\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          return _response2.data;\n        }\n      } catch (error) {\n        var _error$response4, _error$response4$data;\n        throw new Error(`Failed to update receipt: ${((_error$response4 = error.response) == null ? void 0 : (_error$response4$data = _error$response4.data) == null ? void 0 : _error$response4$data.message) || error.message}`);\n      }\n    });\n    function updateReceipt(_x3, _x4) {\n      return _updateReceipt.apply(this, arguments);\n    }\n    return updateReceipt;\n  }(),\n  deleteReceipt: function () {\n    var _deleteReceipt = _asyncToGenerator(function* (receiptId) {\n      try {\n        var token = yield getAuthToken();\n        var response = yield axios.delete(`${API_URL}/api/receipts/${receiptId}`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        return response.data;\n      } catch (error) {\n        var _error$response5, _error$response5$data;\n        throw new Error(`Failed to delete receipt: ${((_error$response5 = error.response) == null ? void 0 : (_error$response5$data = _error$response5.data) == null ? void 0 : _error$response5$data.message) || error.message}`);\n      }\n    });\n    function deleteReceipt(_x5) {\n      return _deleteReceipt.apply(this, arguments);\n    }\n    return deleteReceipt;\n  }()\n};\nexport default receiptApi;","map":{"version":3,"names":["axios","auth","API_URL","process","env","REACT_APP_API_URL","getAuthToken","_ref","_asyncToGenerator","user","currentUser","Error","getIdToken","apply","arguments","receiptApi","createReceipt","_createReceipt","receiptData","imageFile","length","undefined","token","formData","FormData","append","JSON","stringify","response","post","headers","data","error","_error$response","_error$response$data","message","_x","getReceipts","_getReceipts","filters","get","params","_error$response2","_error$response2$data","getReceiptById","_getReceiptById","receiptId","_error$response3","_error$response3$data","_x2","updateReceipt","_updateReceipt","updateData","newImageFile","put","_error$response4","_error$response4$data","_x3","_x4","deleteReceipt","_deleteReceipt","delete","_error$response5","_error$response5$data","_x5"],"sources":["C:/Users/user/Documents/app.v3/client/src/features/receipts/services/receipts.js"],"sourcesContent":["import axios from 'axios';\r\nimport { auth } from '../../../core/config/firebase';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001';\r\n\r\n// Get authentication token\r\nconst getAuthToken = async () => {\r\n  const user = auth.currentUser;\r\n  if (!user) {\r\n    throw new Error('User not authenticated');\r\n  }\r\n  return await user.getIdToken();\r\n};\r\n\r\nexport const receiptApi = {\r\n  // Create new receipt\r\n  createReceipt: async (receiptData, imageFile = null) => {\r\n    try {\r\n      const token = await getAuthToken();\r\n      \r\n      if (imageFile) {\r\n        // Create form data for file upload\r\n        const formData = new FormData();\r\n        formData.append('receipt', imageFile);\r\n        \r\n        // Add receipt data as JSON field\r\n        formData.append('data', JSON.stringify(receiptData));\r\n        \r\n        const response = await axios.post(\r\n          `${API_URL}/api/receipts/upload`,\r\n          formData,\r\n          {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data',\r\n              'Authorization': `Bearer ${token}`\r\n            }\r\n          }\r\n        );\r\n        \r\n        return response.data;\r\n      } else {\r\n        // No image, just send JSON data\r\n        const response = await axios.post(\r\n          `${API_URL}/api/receipts`,\r\n          receiptData,\r\n          {\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Authorization': `Bearer ${token}`\r\n            }\r\n          }\r\n        );\r\n        \r\n        return response.data;\r\n      }\r\n    } catch (error) {\r\n      throw new Error(`Failed to create receipt: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  },\r\n\r\n  // Get receipts with filters\r\n  getReceipts: async (filters = {}) => {\r\n    try {\r\n      const token = await getAuthToken();\r\n      \r\n      const response = await axios.get(\r\n        `${API_URL}/api/receipts`,\r\n        {\r\n          params: filters,\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        }\r\n      );\r\n      \r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(`Failed to fetch receipts: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  },\r\n\r\n  // Get single receipt by ID\r\n  getReceiptById: async (receiptId) => {\r\n    try {\r\n      const token = await getAuthToken();\r\n      \r\n      const response = await axios.get(\r\n        `${API_URL}/api/receipts/${receiptId}`,\r\n        {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        }\r\n      );\r\n      \r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(`Failed to fetch receipt: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  },\r\n\r\n  // Update receipt\r\n  updateReceipt: async (receiptId, updateData, newImageFile = null) => {\r\n    try {\r\n      const token = await getAuthToken();\r\n      \r\n      if (newImageFile) {\r\n        // Create form data for file upload\r\n        const formData = new FormData();\r\n        formData.append('receipt', newImageFile);\r\n        \r\n        // Add receipt data as JSON field\r\n        formData.append('data', JSON.stringify(updateData));\r\n        \r\n        const response = await axios.put(\r\n          `${API_URL}/api/receipts/${receiptId}/upload`,\r\n          formData,\r\n          {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data',\r\n              'Authorization': `Bearer ${token}`\r\n            }\r\n          }\r\n        );\r\n        \r\n        return response.data;\r\n      } else {\r\n        // No image, just send JSON data\r\n        const response = await axios.put(\r\n          `${API_URL}/api/receipts/${receiptId}`,\r\n          updateData,\r\n          {\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Authorization': `Bearer ${token}`\r\n            }\r\n          }\r\n        );\r\n        \r\n        return response.data;\r\n      }\r\n    } catch (error) {\r\n      throw new Error(`Failed to update receipt: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  },\r\n\r\n  // Delete receipt\r\n  deleteReceipt: async (receiptId) => {\r\n    try {\r\n      const token = await getAuthToken();\r\n      \r\n      const response = await axios.delete(\r\n        `${API_URL}/api/receipts/${receiptId}`,\r\n        {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        }\r\n      );\r\n      \r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(`Failed to delete receipt: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  }\r\n};\r\n\r\nexport default receiptApi;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}