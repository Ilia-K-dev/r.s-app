{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useState, useCallback } from 'react';\nexport var useCamera = function useCamera() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    stream = _useState2[0],\n    setStream = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    error = _useState4[0],\n    setError = _useState4[1];\n  var startCamera = useCallback(_asyncToGenerator(function* () {\n    try {\n      var mediaStream = yield navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {\n            ideal: 1920\n          },\n          height: {\n            ideal: 1080\n          }\n        },\n        audio: false\n      });\n      setStream(mediaStream);\n      setError(null);\n      return mediaStream;\n    } catch (err) {\n      setError('Failed to access camera');\n      throw err;\n    }\n  }), []);\n  var stopCamera = useCallback(function () {\n    if (stream) {\n      stream.getTracks().forEach(function (track) {\n        return track.stop();\n      });\n      setStream(null);\n    }\n  }, [stream]);\n  var capturePhoto = useCallback(_asyncToGenerator(function* () {\n    if (!stream) throw new Error('Camera not started');\n    var video = document.createElement('video');\n    video.srcObject = stream;\n    video.setAttribute('playsinline', true);\n    try {\n      yield video.play();\n      var canvas = document.createElement('canvas');\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(video, 0, 0);\n      return new Promise(function (resolve) {\n        canvas.toBlob(function (blob) {\n          resolve(new File([blob], 'captured-photo.jpg', {\n            type: 'image/jpeg',\n            lastModified: Date.now()\n          }));\n        }, 'image/jpeg', 0.9);\n      });\n    } catch (err) {\n      setError('Failed to capture photo');\n      throw err;\n    } finally {\n      video.remove();\n    }\n  }), [stream]);\n  var switchCamera = useCallback(_asyncToGenerator(function* () {\n    if (stream) {\n      var currentFacingMode = stream.getVideoTracks()[0].getSettings().facingMode;\n      var newFacingMode = currentFacingMode === 'environment' ? 'user' : 'environment';\n      stopCamera();\n      try {\n        var newStream = yield navigator.mediaDevices.getUserMedia({\n          video: {\n            facingMode: newFacingMode,\n            width: {\n              ideal: 1920\n            },\n            height: {\n              ideal: 1080\n            }\n          },\n          audio: false\n        });\n        setStream(newStream);\n        setError(null);\n        return newStream;\n      } catch (err) {\n        setError('Failed to switch camera');\n        throw err;\n      }\n    }\n  }), [stream, stopCamera]);\n  return {\n    stream: stream,\n    error: error,\n    startCamera: startCamera,\n    stopCamera: stopCamera,\n    capturePhoto: capturePhoto,\n    switchCamera: switchCamera,\n    isActive: !!stream\n  };\n};\nexport default useCamera;","map":{"version":3,"names":["useState","useCallback","useCamera","_useState","_useState2","_slicedToArray","stream","setStream","_useState3","_useState4","error","setError","startCamera","_asyncToGenerator","mediaStream","navigator","mediaDevices","getUserMedia","video","facingMode","width","ideal","height","audio","err","stopCamera","getTracks","forEach","track","stop","capturePhoto","Error","document","createElement","srcObject","setAttribute","play","canvas","videoWidth","videoHeight","ctx","getContext","drawImage","Promise","resolve","toBlob","blob","File","type","lastModified","Date","now","remove","switchCamera","currentFacingMode","getVideoTracks","getSettings","newFacingMode","newStream","isActive"],"sources":["C:/Users/user/Documents/app.v3/client/src/features/documents/hooks/useCamera.js"],"sourcesContent":["import { useState, useCallback } from 'react';\r\n\r\nexport const useCamera = () => {\r\n  const [stream, setStream] = useState(null);\r\n  const [error, setError] = useState(null);\r\n\r\n  const startCamera = useCallback(async () => {\r\n    try {\r\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\r\n        video: {\r\n          facingMode: 'environment',\r\n          width: { ideal: 1920 },\r\n          height: { ideal: 1080 },\r\n        },\r\n        audio: false,\r\n      });\r\n      setStream(mediaStream);\r\n      setError(null);\r\n      return mediaStream;\r\n    } catch (err) {\r\n      setError('Failed to access camera');\r\n      throw err;\r\n    }\r\n  }, []);\r\n\r\n  const stopCamera = useCallback(() => {\r\n    if (stream) {\r\n      stream.getTracks().forEach(track => track.stop());\r\n      setStream(null);\r\n    }\r\n  }, [stream]);\r\n\r\n  const capturePhoto = useCallback(async () => {\r\n    if (!stream) throw new Error('Camera not started');\r\n\r\n    const video = document.createElement('video');\r\n    video.srcObject = stream;\r\n    video.setAttribute('playsinline', true); // required for iOS\r\n\r\n    try {\r\n      await video.play();\r\n\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = video.videoWidth;\r\n      canvas.height = video.videoHeight;\r\n\r\n      const ctx = canvas.getContext('2d');\r\n      ctx.drawImage(video, 0, 0);\r\n\r\n      return new Promise(resolve => {\r\n        canvas.toBlob(\r\n          blob => {\r\n            resolve(\r\n              new File([blob], 'captured-photo.jpg', {\r\n                type: 'image/jpeg',\r\n                lastModified: Date.now(),\r\n              })\r\n            );\r\n          },\r\n          'image/jpeg',\r\n          0.9\r\n        );\r\n      });\r\n    } catch (err) {\r\n      setError('Failed to capture photo');\r\n      throw err;\r\n    } finally {\r\n      video.remove();\r\n    }\r\n  }, [stream]);\r\n\r\n  const switchCamera = useCallback(async () => {\r\n    if (stream) {\r\n      const currentFacingMode = stream.getVideoTracks()[0].getSettings().facingMode;\r\n      const newFacingMode = currentFacingMode === 'environment' ? 'user' : 'environment';\r\n\r\n      stopCamera();\r\n\r\n      try {\r\n        const newStream = await navigator.mediaDevices.getUserMedia({\r\n          video: {\r\n            facingMode: newFacingMode,\r\n            width: { ideal: 1920 },\r\n            height: { ideal: 1080 },\r\n          },\r\n          audio: false,\r\n        });\r\n        setStream(newStream);\r\n        setError(null);\r\n        return newStream;\r\n      } catch (err) {\r\n        setError('Failed to switch camera');\r\n        throw err;\r\n      }\r\n    }\r\n  }, [stream, stopCamera]);\r\n\r\n  return {\r\n    stream,\r\n    error,\r\n    startCamera,\r\n    stopCamera,\r\n    capturePhoto,\r\n    switchCamera,\r\n    isActive: !!stream,\r\n  };\r\n};\r\n\r\nexport default useCamera;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}